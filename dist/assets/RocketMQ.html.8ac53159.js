import{_ as n}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as s,c as a,f as e}from"./app.c4e9f175.js";const t={},o=e(`<h3 id="_1-1rocketmq\u7531\u54EA\u4E9B\u89D2\u8272\u7EC4\u6210-\u6BCF\u4E2A\u89D2\u8272\u4F5C\u7528\u548C\u7279\u70B9\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_1-1rocketmq\u7531\u54EA\u4E9B\u89D2\u8272\u7EC4\u6210-\u6BCF\u4E2A\u89D2\u8272\u4F5C\u7528\u548C\u7279\u70B9\u662F\u4EC0\u4E48" aria-hidden="true">#</a> 1.1RocketMQ\u7531\u54EA\u4E9B\u89D2\u8272\u7EC4\u6210\uFF0C\u6BCF\u4E2A\u89D2\u8272\u4F5C\u7528\u548C\u7279\u70B9\u662F\u4EC0\u4E48\uFF1F</h3><table><thead><tr><th>\u89D2\u8272</th><th>\u4F5C\u7528</th></tr></thead><tbody><tr><td>Nameserver</td><td>\u65E0\u72B6\u6001\uFF0C\u52A8\u6001\u5217\u8868\uFF1B\u8FD9\u4E5F\u662F\u548Czookeeper\u7684\u91CD\u8981\u533A\u522B\u4E4B\u4E00\u3002zookeeper\u662F\u6709\u72B6\u6001\u7684\u3002</td></tr><tr><td>Producer</td><td>\u6D88\u606F\u751F\u4EA7\u8005\uFF0C\u8D1F\u8D23\u53D1\u6D88\u606F\u5230Broker\u3002</td></tr><tr><td>Broker</td><td>\u5C31\u662FMQ\u672C\u8EAB\uFF0C\u8D1F\u8D23\u6536\u53D1\u6D88\u606F\u3001\u6301\u4E45\u5316\u6D88\u606F\u7B49\u3002</td></tr><tr><td>Consumer</td><td>\u6D88\u606F\u6D88\u8D39\u8005\uFF0C\u8D1F\u8D23\u4ECEBroker\u4E0A\u62C9\u53D6\u6D88\u606F\u8FDB\u884C\u6D88\u8D39\uFF0C\u6D88\u8D39\u5B8C\u8FDB\u884Cack\u3002</td></tr></tbody></table><h3 id="_1-2rocketmq\u4E2D\u7684topic\u548Cjms\u7684queue\u6709\u4EC0\u4E48\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#_1-2rocketmq\u4E2D\u7684topic\u548Cjms\u7684queue\u6709\u4EC0\u4E48\u533A\u522B" aria-hidden="true">#</a> 1.2RocketMQ\u4E2D\u7684Topic\u548CJMS\u7684queue\u6709\u4EC0\u4E48\u533A\u522B\uFF1F</h3><p>queue \u5C31\u662F\u6765\u6E90\u4E8E\u6570\u636E\u7ED3\u6784\u7684 FIFO \u961F\u5217\u3002\u800C Topic \u662F\u4E2A\u62BD\u8C61\u7684\u6982\u5FF5\uFF0C\u6BCF\u4E2A Topic \u5E95\u5C42\u5BF9\u5E94N\u4E2A queue\uFF0C\u800C\u6570\u636E\u4E5F\u771F\u5B9E\u5B58\u5728 queue \u4E0A\u7684\u3002</p><h3 id="_1-3rocketmq-broker\u4E2D\u7684\u6D88\u606F\u88AB\u6D88\u8D39\u540E\u4F1A\u7ACB\u5373\u5220\u9664\u5417" tabindex="-1"><a class="header-anchor" href="#_1-3rocketmq-broker\u4E2D\u7684\u6D88\u606F\u88AB\u6D88\u8D39\u540E\u4F1A\u7ACB\u5373\u5220\u9664\u5417" aria-hidden="true">#</a> 1.3RocketMQ Broker\u4E2D\u7684\u6D88\u606F\u88AB\u6D88\u8D39\u540E\u4F1A\u7ACB\u5373\u5220\u9664\u5417\uFF1F</h3><p><strong>\u4E0D\u4F1A</strong>\uFF0C\u6BCF\u6761\u6D88\u606F\u90FD\u4F1A\u6301\u4E45\u5316\u5230CommitLog\u4E2D\uFF0C\u6BCF\u4E2AConsumer\u8FDE\u63A5\u5230Broker\u540E\u4F1A\u7EF4\u6301\u6D88\u8D39\u8FDB\u5EA6\u4FE1\u606F\uFF0C\u5F53\u6709\u6D88\u606F\u6D88\u8D39\u540E\u53EA\u662F\u5F53\u524DConsumer\u7684\u6D88\u8D39\u8FDB\u5EA6\uFF08CommitLog\u7684offset\uFF09\u66F4\u65B0\u4E86\u3002</p><p>4.6\u7248\u672C\u9ED8\u8BA448\u5C0F\u65F6\u540E\u4F1A\u5220\u9664\u4E0D\u518D\u4F7F\u7528\u7684CommitLog\u6587\u4EF6</p><ul><li>\u68C0\u67E5\u8FD9\u4E2A\u6587\u4EF6\u6700\u540E\u8BBF\u95EE\u65F6\u95F4</li><li>\u5224\u65AD\u662F\u5426\u5927\u4E8E\u8FC7\u671F\u65F6\u95F4</li><li>\u6307\u5B9A\u65F6\u95F4\u5220\u9664\uFF0C\u9ED8\u8BA4\u51CC\u66684\u70B9</li></ul><p>\u6E90\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>rocketmq<span class="token punctuation">.</span>store<span class="token punctuation">.</span></span><span class="token class-name">DefaultMessageStore</span><span class="token punctuation">.</span><span class="token class-name">CleanCommitLogService</span><span class="token punctuation">#</span><span class="token function">isTimeToDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span>
 */</span>
<span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isTimeToDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// when = &quot;04&quot;;</span>
    <span class="token class-name">String</span> when <span class="token operator">=</span> <span class="token class-name">DefaultMessageStore</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMessageStoreConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeleteWhen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u662F04\u70B9\uFF0C\u5C31\u8FD4\u56DEtrue</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">UtilAll</span><span class="token punctuation">.</span><span class="token function">isItTimeToDo</span><span class="token punctuation">(</span>when<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 <span class="token comment">// \u4E0D\u662F04\u70B9\uFF0C\u8FD4\u56DEfalse</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token doc-comment comment">/**
 * <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>rocketmq<span class="token punctuation">.</span>store<span class="token punctuation">.</span></span><span class="token class-name">DefaultMessageStore</span><span class="token punctuation">.</span><span class="token class-name">CleanCommitLogService</span><span class="token punctuation">#</span><span class="token function">deleteExpiredFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span>
 */</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">deleteExpiredFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// isTimeToDelete()\u8FD9\u4E2A\u65B9\u6CD5\u662F\u5224\u65AD\u662F\u4E0D\u662F\u51CC\u6668\u56DB\u70B9\uFF0C\u662F\u7684\u8BDD\u5C31\u6267\u884C\u5220\u9664\u903B\u8F91\u3002</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isTimeToDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u9ED8\u8BA4\u662F72\uFF0C\u4F46\u662Fbroker\u914D\u7F6E\u6587\u4EF6\u9ED8\u8BA4\u6539\u6210\u4E8648\uFF0C\u6240\u4EE5\u65B0\u7248\u672C\u90FD\u662F48\u3002</span>
        <span class="token keyword">long</span> fileReservedTime <span class="token operator">=</span> <span class="token number">48</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
        deleteCount <span class="token operator">=</span> <span class="token class-name">DefaultMessageStore</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>commitLog<span class="token punctuation">.</span><span class="token function">deleteExpiredFile</span><span class="token punctuation">(</span><span class="token number">72</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> xx<span class="token punctuation">,</span> xx<span class="token punctuation">,</span> xx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>                                                                     
<span class="token doc-comment comment">/**
 * <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>rocketmq<span class="token punctuation">.</span>store<span class="token punctuation">.</span></span><span class="token class-name">CommitLog</span><span class="token punctuation">#</span><span class="token function">deleteExpiredFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span>
 */</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deleteExpiredFile</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u8FD9\u4E2A\u65B9\u6CD5\u7684\u4E3B\u903B\u8F91\u5C31\u662F\u904D\u5386\u67E5\u627E\u6700\u540E\u66F4\u6539\u65F6\u95F4+\u8FC7\u671F\u65F6\u95F4\uFF0C\u5C0F\u4E8E\u5F53\u524D\u7CFB\u7EDF\u65F6\u95F4\u7684\u8BDD\u5C31\u5220\u4E86\uFF08\u4E5F\u5C31\u662F\u5C0F\u4E8E48\u5C0F\u65F6\uFF09\u3002</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mappedFileQueue<span class="token punctuation">.</span><span class="token function">deleteExpiredFileByTime</span><span class="token punctuation">(</span><span class="token number">72</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span> xx<span class="token punctuation">,</span> xx<span class="token punctuation">,</span> xx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-4rocketmq\u6D88\u8D39\u6A21\u5F0F\u6709\u51E0\u79CD" tabindex="-1"><a class="header-anchor" href="#_1-4rocketmq\u6D88\u8D39\u6A21\u5F0F\u6709\u51E0\u79CD" aria-hidden="true">#</a> 1.4RocketMQ\u6D88\u8D39\u6A21\u5F0F\u6709\u51E0\u79CD\uFF1F</h3><p>\u6D88\u8D39\u6A21\u578B\u7531 Consumer \u51B3\u5B9A\uFF0C\u6D88\u8D39\u7EF4\u5EA6\u4E3A Topic\u3002</p><ul><li>\u96C6\u7FA4\u6D88\u8D39 <ul><li>\u4E00\u6761\u6D88\u606F\u53EA\u4F1A\u88AB\u540CGroup\u4E2D\u7684\u4E00\u4E2AConsumer\u6D88\u8D39</li><li>\u591A\u4E2AGroup\u540C\u65F6\u6D88\u8D39\u4E00\u4E2ATopic\u65F6\uFF0C\u6BCF\u4E2AGroup\u90FD\u4F1A\u6709\u4E00\u4E2AConsumer\u6D88\u8D39\u5230\u6570\u636E</li></ul></li><li>\u5E7F\u64AD\u6D88\u8D39 \u6D88\u606F\u5C06\u5BF9\u4E00 \u4E2A Consumer Group \u4E0B\u7684\u5404\u4E2A Consumer \u5B9E\u4F8B\u90FD\u6D88\u8D39\u4E00\u904D\u3002\u5373\u5373\u4F7F\u8FD9\u4E9B Consumer \u5C5E\u4E8E\u540C\u4E00\u4E2A Consumer Group \uFF0C\u6D88\u606F\u4E5F\u4F1A\u88AB Consumer Group \u4E2D\u7684\u6BCF\u4E2A Consumer \u90FD\u6D88\u8D39\u4E00\u6B21\u3002</li></ul><h3 id="_1-5rocketmq\u6D88\u606F\u662Fpush\u8FD8\u662Fpull" tabindex="-1"><a class="header-anchor" href="#_1-5rocketmq\u6D88\u606F\u662Fpush\u8FD8\u662Fpull" aria-hidden="true">#</a> 1.5RocketMQ\u6D88\u606F\u662Fpush\u8FD8\u662Fpull\uFF1F</h3><p>RocketMQ\u6CA1\u6709\u771F\u6B63\u610F\u4E49\u7684push\uFF0C\u90FD\u662Fpull\uFF0C\u867D\u7136\u6709push\u7C7B\uFF0C\u4F46\u5B9E\u9645\u5E95\u5C42\u5B9E\u73B0\u91C7\u7528\u7684\u662F<strong>\u957F\u8F6E\u8BE2\u673A\u5236</strong>\uFF0C\u5373\u62C9\u53D6\u65B9\u5F0F</p><blockquote><p>broker\u7AEF\u5C5E\u6027 longPollingEnable \u6807\u8BB0\u662F\u5426\u5F00\u542F\u957F\u8F6E\u8BE2\u3002\u9ED8\u8BA4\u5F00\u542F</p></blockquote><p>\u6E90\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// {@link org.apache.rocketmq.client.impl.consumer.DefaultMQPushConsumerImpl#pullMessage()}</span>
<span class="token comment">// \u770B\u5230\u6CA1\uFF0C\u8FD9\u662F\u4E00\u53EA\u62AB\u7740\u7F8A\u76AE\u7684\u72FC\uFF0C\u540D\u5B57\u53EBPushConsumerImpl\uFF0C\u5B9E\u9645\u5E72\u7684\u786E\u662Fpull\u7684\u6D3B\u3002</span>
<span class="token comment">// \u62C9\u53D6\u6D88\u606F\uFF0C\u7ED3\u679C\u653E\u5230pullCallback\u91CC</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>pullAPIWrapper<span class="token punctuation">.</span><span class="token function">pullKernelImpl</span><span class="token punctuation">(</span>pullCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-6\u4E3A\u4EC0\u4E48\u8981\u4E3B\u52A8\u62C9\u53D6\u6D88\u606F\u800C\u4E0D\u4F7F\u7528\u4E8B\u4EF6\u76D1\u542C\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#_1-6\u4E3A\u4EC0\u4E48\u8981\u4E3B\u52A8\u62C9\u53D6\u6D88\u606F\u800C\u4E0D\u4F7F\u7528\u4E8B\u4EF6\u76D1\u542C\u65B9\u5F0F" aria-hidden="true">#</a> 1.6\u4E3A\u4EC0\u4E48\u8981\u4E3B\u52A8\u62C9\u53D6\u6D88\u606F\u800C\u4E0D\u4F7F\u7528\u4E8B\u4EF6\u76D1\u542C\u65B9\u5F0F\uFF1F</h3><p>\u4E8B\u4EF6\u9A71\u52A8\u65B9\u5F0F\u662F\u5EFA\u7ACB\u597D\u957F\u8FDE\u63A5\uFF0C\u7531\u4E8B\u4EF6\uFF08\u53D1\u9001\u6570\u636E\uFF09\u7684\u65B9\u5F0F\u6765\u5B9E\u65F6\u63A8\u9001\u3002</p><p>\u5982\u679Cbroker\u4E3B\u52A8\u63A8\u9001\u6D88\u606F\u7684\u8BDD\u6709\u53EF\u80FDpush\u901F\u5EA6\u5FEB\uFF0C\u6D88\u8D39\u901F\u5EA6\u6162\u7684\u60C5\u51B5\uFF0C\u90A3\u4E48\u5C31\u4F1A\u9020\u6210\u6D88\u606F\u5728 Consumer \u7AEF\u5806\u79EF\u8FC7\u591A\uFF0C\u540C\u65F6\u53C8\u4E0D\u80FD\u88AB\u5176\u4ED6 Consumer \u6D88\u8D39\u7684\u60C5\u51B5\u3002\u800C pull \u7684\u65B9\u5F0F\u53EF\u4EE5\u6839\u636E\u5F53\u524D\u81EA\u8EAB\u60C5\u51B5\u6765 pull\uFF0C\u4E0D\u4F1A\u9020\u6210\u8FC7\u591A\u7684\u538B\u529B\u800C\u9020\u6210\u74F6\u9888\u3002\u6240\u4EE5\u91C7\u53D6\u4E86 pull \u7684\u65B9\u5F0F\u3002</p><h3 id="_1-7broker\u5982\u4F55\u5904\u7406\u62C9\u53D6\u8BF7\u6C42\u7684" tabindex="-1"><a class="header-anchor" href="#_1-7broker\u5982\u4F55\u5904\u7406\u62C9\u53D6\u8BF7\u6C42\u7684" aria-hidden="true">#</a> 1.7Broker\u5982\u4F55\u5904\u7406\u62C9\u53D6\u8BF7\u6C42\u7684\uFF1F</h3><p>Consumer\u9996\u6B21\u8BF7\u6C42Broker Broker\u4E2D\u662F\u5426\u6709\u7B26\u5408\u6761\u4EF6\u7684\u6D88\u606F</p><ul><li>\u6709 <ul><li>\u54CD\u5E94 Consumer</li><li>\u7B49\u5F85\u4E0B\u6B21 Consumer \u7684\u8BF7\u6C42</li></ul></li><li>\u6CA1\u6709 <ul><li>DefaultMessageStore#ReputMessageService#run\u65B9\u6CD5</li><li>PullRequestHoldService \u6765 Hold \u8FDE\u63A5\uFF0C\u6BCF\u4E2A 5s \u6267\u884C\u4E00\u6B21\u68C0\u67E5 pullRequestTable \u6709\u6CA1\u6709\u6D88\u606F\uFF0C\u6709\u7684\u8BDD\u7ACB\u5373\u63A8\u9001</li><li>\u6BCF\u9694 1ms \u68C0\u67E5 commitLog \u4E2D\u662F\u5426\u6709\u65B0\u6D88\u606F\uFF0C\u6709\u7684\u8BDD\u5199\u5165\u5230 pullRequestTable</li><li>\u5F53\u6709\u65B0\u6D88\u606F\u7684\u65F6\u5019\u8FD4\u56DE\u8BF7\u6C42</li><li>\u6302\u8D77 consumer \u7684\u8BF7\u6C42\uFF0C\u5373\u4E0D\u65AD\u5F00\u8FDE\u63A5\uFF0C\u4E5F\u4E0D\u8FD4\u56DE\u6570\u636E</li><li>\u4F7F\u7528 consumer \u7684 offset\uFF0C</li></ul></li></ul><h3 id="_1-8rocketmq\u5982\u4F55\u505A\u8D1F\u8F7D\u5747\u8861" tabindex="-1"><a class="header-anchor" href="#_1-8rocketmq\u5982\u4F55\u505A\u8D1F\u8F7D\u5747\u8861" aria-hidden="true">#</a> 1.8RocketMQ\u5982\u4F55\u505A\u8D1F\u8F7D\u5747\u8861\uFF1F</h3><p>\u901A\u8FC7Topic\u5728\u591ABroker\u4E2D\u5206\u5E03\u5F0F\u5B58\u50A8\u5B9E\u73B0\u3002</p><h3 id="_1-9producer\u7AEF" tabindex="-1"><a class="header-anchor" href="#_1-9producer\u7AEF" aria-hidden="true">#</a> <strong>1.9producer\u7AEF</strong></h3><p>\u53D1\u9001\u7AEF\u6307\u5B9A message queue\u53D1\u9001\u6D88\u606F\u5230\u76F8\u5E94\u7684 broker\uFF0C\u6765\u8FBE\u5230\u5199\u5165\u65F6\u7684\u8D1F\u8F7D\u5747\u8861</p><ul><li>\u63D0\u5347\u5199\u5165\u541E\u5410\u91CF\uFF0C\u5F53\u591A\u4E2Aproducer\u540C\u65F6\u5411\u4E00\u4E2A broker \u5199\u5165\u6570\u636E\u7684\u65F6\u5019\uFF0C\u6027\u80FD\u4F1A\u4E0B\u964D</li><li>\u6D88\u606F\u5206\u5E03\u5728\u591A broker \u4E2D\uFF0C\u4E3A\u8D1F\u8F7D\u6D88\u8D39\u505A\u51C6\u5907</li></ul><p>\u9ED8\u8BA4\u7B56\u7565\u662F\u968F\u673A\u9009\u62E9\uFF1A</p><ul><li>producer \u7EF4\u62A4\u4E00\u4E2A index</li><li>\u6BCF\u6B21\u53D6\u8282\u70B9\u4F1A\u81EA\u589E</li><li>index \u5411\u6240\u6709 broker \u4E2A\u6570\u53D6\u4F59</li><li>\u81EA\u5E26\u5BB9\u9519\u7B56\u7565</li></ul><p>\u5176\u4ED6\u5B9E\u73B0\uFF1A</p><ul><li>SelectMessageQueueByHash</li><li>hash\u7684\u662F\u4F20\u5165\u7684args</li><li>SelectMessageQueueByRandom</li><li>SelectMessageQueueByMachineRoom \u6CA1\u6709\u5B9E\u73B0</li></ul><p>\u4E5F\u53EF\u4EE5\u81EA\u5B9A\u4E49\u5B9E\u73B0<strong>MessageQueueSelector</strong>\u63A5\u53E3\u4E2D\u7684select\u65B9\u6CD5</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">MessageQueue</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MessageQueue</span><span class="token punctuation">&gt;</span></span> mqs<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Message</span> msg<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-10consumer\u7AEF" tabindex="-1"><a class="header-anchor" href="#_1-10consumer\u7AEF" aria-hidden="true">#</a> <strong>1.10consumer\u7AEF</strong></h3><p>\u91C7\u7528\u7684\u662F\u5E73\u5747\u5206\u914D\u7B97\u6CD5\u6765\u8FDB\u884C\u8D1F\u8F7D\u5747\u8861\u3002</p><p><strong>\u5176\u4ED6\u8D1F\u8F7D\u5747\u8861\u7B97\u6CD5</strong></p><ul><li>\u5E73\u5747\u5206\u914D\u7B56\u7565(<strong>\u9ED8\u8BA4</strong>)(AllocateMessageQueueAveragely)</li><li>\u73AF\u5F62\u5206\u914D\u7B56\u7565(AllocateMessageQueueAveragelyByCircle)</li><li>\u624B\u52A8\u914D\u7F6E\u5206\u914D\u7B56\u7565(AllocateMessageQueueByConfig)</li><li>\u673A\u623F\u5206\u914D\u7B56\u7565(AllocateMessageQueueByMachineRoom)</li><li>\u4E00\u81F4\u6027\u54C8\u5E0C\u5206\u914D\u7B56\u7565(AllocateMessageQueueConsistentHash)</li><li>\u9760\u8FD1\u673A\u623F\u7B56\u7565(AllocateMachineRoomNearby)</li></ul><h3 id="_1-11\u5F53\u6D88\u8D39\u8D1F\u8F7D\u5747\u8861consumer\u548Cqueue\u4E0D\u5BF9\u7B49\u7684\u65F6\u5019\u4F1A\u53D1\u751F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_1-11\u5F53\u6D88\u8D39\u8D1F\u8F7D\u5747\u8861consumer\u548Cqueue\u4E0D\u5BF9\u7B49\u7684\u65F6\u5019\u4F1A\u53D1\u751F\u4EC0\u4E48" aria-hidden="true">#</a> 1.11\u5F53\u6D88\u8D39\u8D1F\u8F7D\u5747\u8861consumer\u548Cqueue\u4E0D\u5BF9\u7B49\u7684\u65F6\u5019\u4F1A\u53D1\u751F\u4EC0\u4E48\uFF1F</h3><p>Consumer \u548C queue \u4F1A\u4F18\u5148\u5E73\u5747\u5206\u914D\uFF0C\u5982\u679C Consumer \u5C11\u4E8E queue \u7684\u4E2A\u6570\uFF0C\u5219\u4F1A\u5B58\u5728\u90E8\u5206 Consumer \u6D88\u8D39\u591A\u4E2A queue \u7684\u60C5\u51B5\uFF0C\u5982\u679C Consumer \u7B49\u4E8E queue \u7684\u4E2A\u6570\uFF0C\u90A3\u5C31\u662F\u4E00\u4E2A Consumer \u6D88\u8D39\u4E00\u4E2A queue\uFF0C\u5982\u679C Consumer \u4E2A\u6570\u5927\u4E8E queue \u7684\u4E2A\u6570\uFF0C\u90A3\u4E48\u4F1A\u6709\u90E8\u5206 Consumer \u7A7A\u4F59\u51FA\u6765\uFF0C\u767D\u767D\u7684\u6D6A\u8D39\u4E86\u3002</p><h3 id="_1-12\u6D88\u606F\u91CD\u590D\u6D88\u8D39\u5982\u4F55\u89E3\u51B3" tabindex="-1"><a class="header-anchor" href="#_1-12\u6D88\u606F\u91CD\u590D\u6D88\u8D39\u5982\u4F55\u89E3\u51B3" aria-hidden="true">#</a> 1.12\u6D88\u606F\u91CD\u590D\u6D88\u8D39\u5982\u4F55\u89E3\u51B3\uFF1F</h3><p>\u5F71\u54CD\u6D88\u606F\u6B63\u5E38\u53D1\u9001\u548C\u6D88\u8D39\u7684<strong>\u91CD\u8981\u539F\u56E0\u662F\u7F51\u7EDC\u7684\u4E0D\u786E\u5B9A\u6027\u3002</strong></p><ul><li><p><strong>\u5F15\u8D77\u91CD\u590D\u6D88\u8D39\u7684\u539F\u56E0</strong></p><ul><li><p><strong>ACK</strong> \u6B63\u5E38\u60C5\u51B5\u4E0B\u5728consumer\u771F\u6B63\u6D88\u8D39\u5B8C\u6D88\u606F\u540E\u5E94\u8BE5\u53D1\u9001ack\uFF0C\u901A\u77E5broker\u8BE5\u6D88\u606F\u5DF2\u6B63\u5E38\u6D88\u8D39\uFF0C\u4ECEqueue\u4E2D\u5254\u9664</p><p>\u5F53ack\u56E0\u4E3A\u7F51\u7EDC\u539F\u56E0\u65E0\u6CD5\u53D1\u9001\u5230broker\uFF0Cbroker\u4F1A\u8BA4\u4E3A\u8BCD\u6761\u6D88\u606F\u6CA1\u6709\u88AB\u6D88\u8D39\uFF0C\u6B64\u540E\u4F1A\u5F00\u542F\u6D88\u606F\u91CD\u6295\u673A\u5236\u628A\u6D88\u606F\u518D\u6B21\u6295\u9012\u5230consumer</p></li><li><p><strong>\u6D88\u8D39\u6A21\u5F0F</strong> \u5728CLUSTERING\u6A21\u5F0F\u4E0B\uFF0C\u6D88\u606F\u5728broker\u4E2D\u4F1A\u4FDD\u8BC1\u76F8\u540Cgroup\u7684consumer\u6D88\u8D39\u4E00\u6B21\uFF0C\u4F46\u662F\u9488\u5BF9\u4E0D\u540Cgroup\u7684consumer\u4F1A\u63A8\u9001\u591A\u6B21</p></li></ul></li><li><p><strong>\u89E3\u51B3\u65B9\u6848</strong></p><ul><li><p><strong>\u6570\u636E\u5E93\u8868</strong></p><p>\u5904\u7406\u6D88\u606F\u524D\uFF0C\u4F7F\u7528\u6D88\u606F\u4E3B\u952E\u5728\u8868\u4E2D\u5E26\u6709\u7EA6\u675F\u7684\u5B57\u6BB5\u4E2Dinsert</p></li><li><p><strong>Map</strong></p><p>\u5355\u673A\u65F6\u53EF\u4EE5\u4F7F\u7528map <em>ConcurrentHashMap</em> -&gt; putIfAbsent guava cache</p></li><li><p><strong>Redis</strong></p><p>\u5206\u5E03\u5F0F\u9501\u641E\u8D77\u6765\u3002</p></li></ul></li></ul><h3 id="_1-13\u5982\u4F55\u8BA9-rocketmq-\u4FDD\u8BC1\u6D88\u606F\u7684\u987A\u5E8F\u6D88\u8D39" tabindex="-1"><a class="header-anchor" href="#_1-13\u5982\u4F55\u8BA9-rocketmq-\u4FDD\u8BC1\u6D88\u606F\u7684\u987A\u5E8F\u6D88\u8D39" aria-hidden="true">#</a> 1.13\u5982\u4F55\u8BA9 RocketMQ \u4FDD\u8BC1\u6D88\u606F\u7684\u987A\u5E8F\u6D88\u8D39\uFF1F</h3><p>\u9996\u5148\u591A\u4E2A queue \u53EA\u80FD\u4FDD\u8BC1\u5355\u4E2A queue \u91CC\u7684\u987A\u5E8F\uFF0Cqueue \u662F\u5178\u578B\u7684 FIFO\uFF0C\u5929\u7136\u987A\u5E8F\u3002\u591A\u4E2A queue \u540C\u65F6\u6D88\u8D39\u662F\u65E0\u6CD5\u7EDD\u5BF9\u4FDD\u8BC1\u6D88\u606F\u7684\u6709\u5E8F\u6027\u7684\u3002\u6240\u4EE5\u603B\u7ED3\u5982\u4E0B\uFF1A</p><p>\u540C\u4E00 topic\uFF0C\u540C\u4E00\u4E2A QUEUE\uFF0C\u53D1\u6D88\u606F\u7684\u65F6\u5019\u4E00\u4E2A\u7EBF\u7A0B\u53BB\u53D1\u9001\u6D88\u606F\uFF0C\u6D88\u8D39\u7684\u65F6\u5019 \u4E00\u4E2A\u7EBF\u7A0B\u53BB\u6D88\u8D39\u4E00\u4E2A queue \u91CC\u7684\u6D88\u606F\u3002</p><h3 id="_1-14\u600E\u4E48\u4FDD\u8BC1\u6D88\u606F\u53D1\u5230\u540C\u4E00\u4E2Aqueue" tabindex="-1"><a class="header-anchor" href="#_1-14\u600E\u4E48\u4FDD\u8BC1\u6D88\u606F\u53D1\u5230\u540C\u4E00\u4E2Aqueue" aria-hidden="true">#</a> 1.14\u600E\u4E48\u4FDD\u8BC1\u6D88\u606F\u53D1\u5230\u540C\u4E00\u4E2Aqueue\uFF1F</h3><p>Rocket MQ\u7ED9\u6211\u4EEC\u63D0\u4F9B\u4E86MessageQueueSelector\u63A5\u53E3\uFF0C\u53EF\u4EE5\u81EA\u5DF1\u91CD\u5199\u91CC\u9762\u7684\u63A5\u53E3\uFF0C\u5B9E\u73B0\u81EA\u5DF1\u7684\u7B97\u6CD5\uFF0C\u4E3E\u4E2A\u6700\u7B80\u5355\u7684\u4F8B\u5B50\uFF1A\u5224\u65AD<code>i % 2 == 0</code>\uFF0C\u90A3\u5C31\u90FD\u653E\u5230queue1\u91CC\uFF0C\u5426\u5219\u653E\u5230queue2\u91CC\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Message</span> message <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token string">&quot;orderTopic&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;hello!&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>
        <span class="token comment">// \u8981\u53D1\u7684\u90A3\u6761\u6D88\u606F</span>
        message<span class="token punctuation">,</span>
        <span class="token comment">// queue \u9009\u62E9\u5668 \uFF0C\u5411 topic\u4E2D\u7684\u54EA\u4E2Aqueue\u53BB\u5199\u6D88\u606F</span>
        <span class="token keyword">new</span> <span class="token class-name">MessageQueueSelector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u624B\u52A8 \u9009\u62E9\u4E00\u4E2Aqueue</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">MessageQueue</span> <span class="token function">select</span><span class="token punctuation">(</span>
                <span class="token comment">// \u5F53\u524Dtopic \u91CC\u9762\u5305\u542B\u7684\u6240\u6709queue</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MessageQueue</span><span class="token punctuation">&gt;</span></span> mqs<span class="token punctuation">,</span>
                <span class="token comment">// \u5177\u4F53\u8981\u53D1\u7684\u90A3\u6761\u6D88\u606F</span>
                <span class="token class-name">Message</span> msg<span class="token punctuation">,</span>
                <span class="token comment">// \u5BF9\u5E94\u5230 send\uFF08\uFF09 \u91CC\u7684 args\uFF0C\u4E5F\u5C31\u662F2000\u524D\u9762\u7684\u90A3\u4E2A0</span>
                <span class="token class-name">Object</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// \u5411\u56FA\u5B9A\u7684\u4E00\u4E2Aqueue\u91CC\u5199\u6D88\u606F\uFF0C\u6BD4\u5982\u8FD9\u91CC\u5C31\u662F\u5411\u7B2C\u4E00\u4E2Aqueue\u91CC\u5199\u6D88\u606F</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> mqs<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> mqs<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// \u81EA\u5B9A\u4E49\u53C2\u6570\uFF1A0</span>
        <span class="token comment">// 2000\u4EE3\u88682000\u6BEB\u79D2\u8D85\u65F6\u65F6\u95F4</span>
        i<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-15rocketmq\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931" tabindex="-1"><a class="header-anchor" href="#_1-15rocketmq\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931" aria-hidden="true">#</a> 1.15RocketMQ\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931\uFF1F</h3><p>\u9996\u5148\u5728\u5982\u4E0B\u4E09\u4E2A\u90E8\u5206\u90FD\u53EF\u80FD\u4F1A\u51FA\u73B0\u4E22\u5931\u6D88\u606F\u7684\u60C5\u51B5\uFF1A</p><ul><li>Producer\u7AEF</li><li>Broker\u7AEF</li><li>Consumer\u7AEF</li></ul><h3 id="_1-16producer\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931" tabindex="-1"><a class="header-anchor" href="#_1-16producer\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931" aria-hidden="true">#</a> 1.16Producer\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931</h3><ul><li><p>\u91C7\u53D6send()<strong>\u540C\u6B65\u53D1\u6D88\u606F</strong>\uFF0C\u53D1\u9001\u7ED3\u679C\u662F\u540C\u6B65\u611F\u77E5\u7684\u3002</p></li><li><p>\u53D1\u9001\u5931\u8D25\u540E\u53EF\u4EE5<strong>\u91CD\u8BD5</strong>\uFF0C\u8BBE\u7F6E\u91CD\u8BD5\u6B21\u6570\u3002\u9ED8\u8BA43\u6B21\u3002</p><blockquote><p>producer.setRetryTimesWhenSendFailed(10);</p></blockquote></li><li><p><strong>\u96C6\u7FA4\u90E8\u7F72</strong>\uFF0C\u6BD4\u5982\u53D1\u9001\u5931\u8D25\u4E86\u7684\u539F\u56E0\u53EF\u80FD\u662F\u5F53\u524DBroker\u5B95\u673A\u4E86\uFF0C\u91CD\u8BD5\u7684\u65F6\u5019\u4F1A\u53D1\u9001\u5230\u5176\u4ED6Broker\u4E0A\u3002</p></li></ul><h3 id="_1-17broker\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931" tabindex="-1"><a class="header-anchor" href="#_1-17broker\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931" aria-hidden="true">#</a> 1.17Broker\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931</h3><ul><li><p>\u4FEE\u6539\u5237\u76D8\u7B56\u7565\u4E3A\u540C\u6B65\u5237\u76D8\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u662F\u5F02\u6B65\u5237\u76D8\u7684\u3002</p><blockquote><p>flushDiskType = SYNC_FLUSH</p></blockquote></li><li><p>\u96C6\u7FA4\u90E8\u7F72\uFF0C\u4E3B\u4ECE\u6A21\u5F0F\uFF0C\u9AD8\u53EF\u7528\u3002</p></li></ul><h3 id="_1-18consumer\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931" tabindex="-1"><a class="header-anchor" href="#_1-18consumer\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931" aria-hidden="true">#</a> 1.18Consumer\u7AEF\u5982\u4F55\u4FDD\u8BC1\u6D88\u606F\u4E0D\u4E22\u5931</h3><ul><li>\u5B8C\u5168\u6D88\u8D39\u6B63\u5E38\u540E\u5728\u8FDB\u884C\u624B\u52A8ack\u786E\u8BA4\u3002</li></ul><h3 id="_1-19rocketmq\u7684\u6D88\u606F\u5806\u79EF\u5982\u4F55\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_1-19rocketmq\u7684\u6D88\u606F\u5806\u79EF\u5982\u4F55\u5904\u7406" aria-hidden="true">#</a> 1.19RocketMQ\u7684\u6D88\u606F\u5806\u79EF\u5982\u4F55\u5904\u7406\uFF1F</h3><p>\u9996\u5148\u8981\u627E\u5230\u662F\u4EC0\u4E48\u539F\u56E0\u5BFC\u81F4\u7684\u6D88\u606F\u5806\u79EF\uFF0C\u662F Producer \u592A\u591A\u4E86\uFF0CConsumer \u592A\u5C11\u4E86\u5BFC\u81F4\u7684\u8FD8\u662F\u8BF4\u5176\u4ED6\u60C5\u51B5\uFF0C\u603B\u4E4B\u5148\u5B9A\u4F4D\u95EE\u9898\u3002</p><p>\u7136\u540E\u770B\u4E0B\u6D88\u606F\u6D88\u8D39\u901F\u5EA6\u662F\u5426\u6B63\u5E38\uFF0C\u6B63\u5E38\u7684\u8BDD\uFF0C\u53EF\u4EE5\u901A\u8FC7\u4E0A\u7EBF\u66F4\u591A Consumer \u4E34\u65F6\u89E3\u51B3\u6D88\u606F\u5806\u79EF\u95EE\u9898</p><h3 id="_1-20\u5982\u679Cconsumer\u548Cqueue\u4E0D\u5BF9\u7B49-\u4E0A\u7EBF\u4E86\u591A\u53F0\u4E5F\u5728\u77ED\u65F6\u95F4\u5185\u65E0\u6CD5\u6D88\u8D39\u5B8C\u5806\u79EF\u7684\u6D88\u606F\u600E\u4E48\u529E" tabindex="-1"><a class="header-anchor" href="#_1-20\u5982\u679Cconsumer\u548Cqueue\u4E0D\u5BF9\u7B49-\u4E0A\u7EBF\u4E86\u591A\u53F0\u4E5F\u5728\u77ED\u65F6\u95F4\u5185\u65E0\u6CD5\u6D88\u8D39\u5B8C\u5806\u79EF\u7684\u6D88\u606F\u600E\u4E48\u529E" aria-hidden="true">#</a> 1.20\u5982\u679CConsumer\u548CQueue\u4E0D\u5BF9\u7B49\uFF0C\u4E0A\u7EBF\u4E86\u591A\u53F0\u4E5F\u5728\u77ED\u65F6\u95F4\u5185\u65E0\u6CD5\u6D88\u8D39\u5B8C\u5806\u79EF\u7684\u6D88\u606F\u600E\u4E48\u529E\uFF1F</h3><ul><li>\u51C6\u5907\u4E00\u4E2A\u4E34\u65F6\u7684 topic</li><li>queue \u7684\u6570\u91CF\u662F\u5806\u79EF\u7684\u51E0\u500D</li><li>queue \u5206\u5E03\u5230\u591A Broker \u4E2D</li><li>\u4E0A\u7EBF\u4E00\u53F0 Consumer \u505A\u6D88\u606F\u7684\u642C\u8FD0\u5DE5\uFF0C\u628A\u539F\u6765 Topic \u4E2D\u7684\u6D88\u606F\u632A\u5230\u65B0\u7684 Topic\u91CC\uFF0C\u4E0D\u505A\u4E1A\u52A1\u903B\u8F91\u5904\u7406\uFF0C\u53EA\u662F\u632A\u8FC7\u53BB</li><li>\u4E0A\u7EBF N \u53F0 Consumer \u540C\u65F6\u6D88\u8D39\u4E34\u65F6 Topic \u4E2D\u7684\u6570\u636E</li><li>\u6539 bug</li><li>\u6062\u590D\u539F\u6765\u7684 Consumer\uFF0C\u7EE7\u7EED\u6D88\u8D39\u4E4B\u524D\u7684 Topic</li></ul><h3 id="_1-21\u5806\u79EF\u6D88\u606F\u4F1A\u8D85\u65F6\u5220\u9664\u5417" tabindex="-1"><a class="header-anchor" href="#_1-21\u5806\u79EF\u6D88\u606F\u4F1A\u8D85\u65F6\u5220\u9664\u5417" aria-hidden="true">#</a> 1.21\u5806\u79EF\u6D88\u606F\u4F1A\u8D85\u65F6\u5220\u9664\u5417\uFF1F</h3><p><strong>\u4E0D\u4F1A</strong>\uFF1BRocketMQ \u4E2D\u7684\u6D88\u606F\u53EA\u4F1A\u5728 commitLog \u88AB\u5220\u9664\u7684\u65F6\u5019\u624D\u4F1A\u6D88\u5931\u3002\u4E5F\u5C31\u662F\u8BF4\u672A\u88AB\u6D88\u8D39\u7684\u6D88\u606F\u4E0D\u4F1A\u5B58\u5728\u8D85\u65F6\u5220\u9664\u8FD9\u60C5\u51B5\u3002</p><h3 id="_1-22\u5806\u79EF\u7684\u6D88\u606F\u4F1A\u4E0D\u4F1A\u8FDB\u6B7B\u4FE1\u961F\u5217" tabindex="-1"><a class="header-anchor" href="#_1-22\u5806\u79EF\u7684\u6D88\u606F\u4F1A\u4E0D\u4F1A\u8FDB\u6B7B\u4FE1\u961F\u5217" aria-hidden="true">#</a> 1.22\u5806\u79EF\u7684\u6D88\u606F\u4F1A\u4E0D\u4F1A\u8FDB\u6B7B\u4FE1\u961F\u5217\uFF1F</h3><p><strong>\u4E0D\u4F1A</strong>\uFF0C\u6D88\u606F\u5728\u6D88\u8D39\u5931\u8D25\u540E\u4F1A\u8FDB\u5165\u91CD\u8BD5\u961F\u5217\uFF08%RETRY%+ConsumerGroup\uFF09\uFF0C18\u6B21\u624D\u4F1A\u8FDB\u5165\u6B7B\u4FE1\u961F\u5217\uFF08%DLQ%+ConsumerGroup\uFF09\u3002</p><p>\u6E90\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageStoreConfig</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u6BCF\u9694\u5982\u4E0B\u65F6\u95F4\u4F1A\u8FDB\u884C\u91CD\u8BD5\uFF0C\u5230\u6700\u540E\u4E00\u6B21\u65F6\u95F4\u91CD\u8BD5\u5931\u8D25\u7684\u8BDD\u5C31\u8FDB\u5165\u6B7B\u4FE1\u961F\u5217\u4E86\u3002</span>
 <span class="token keyword">private</span> <span class="token class-name">String</span> messageDelayLevel <span class="token operator">=</span> <span class="token string">&quot;1s 5s 10s 30s 1m 2m 3m 4m 5m 6m 7m 8m 9m 10m 20m 30m 1h 2h&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token number">1234</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-23rocketmq-\u5728\u5206\u5E03\u5F0F\u4E8B\u52A1\u652F\u6301\u8FD9\u5757\u673A\u5236\u7684\u5E95\u5C42\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#_1-23rocketmq-\u5728\u5206\u5E03\u5F0F\u4E8B\u52A1\u652F\u6301\u8FD9\u5757\u673A\u5236\u7684\u5E95\u5C42\u539F\u7406" aria-hidden="true">#</a> 1.23RocketMQ \u5728\u5206\u5E03\u5F0F\u4E8B\u52A1\u652F\u6301\u8FD9\u5757\u673A\u5236\u7684\u5E95\u5C42\u539F\u7406?</h3><p>\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u4E8B\u52A1\u53EF\u4EE5\u4F7F\u7528<strong>TCC</strong>\uFF08Try\u3001Confirm\u3001Cancel\uFF09\u3001<strong>2pc</strong>\u6765\u89E3\u51B3\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u6D88\u606F\u539F\u5B50\u6027</p><p>RocketMQ 4.3+ \u63D0\u4F9B\u5206\u5E03\u4E8B\u52A1\u529F\u80FD\uFF0C\u901A\u8FC7 RocketMQ \u4E8B\u52A1\u6D88\u606F\u80FD\u8FBE\u5230\u5206\u5E03\u5F0F\u4E8B\u52A1\u7684\u6700\u7EC8\u4E00\u81F4</p><p><strong>RocketMQ\u5B9E\u73B0\u65B9\u5F0F\uFF1A</strong></p><ul><li><strong>Half Message</strong>\uFF1A \u9884\u5904\u7406\u6D88\u606F\uFF0C\u5F53broker\u6536\u5230\u6B64\u7C7B\u6D88\u606F\u540E\uFF0C\u4F1A\u5B58\u50A8\u5230RMQ_SYS_TRANS_HALF_TOPIC\u7684\u6D88\u606F\u6D88\u8D39\u961F\u5217\u4E2D</li><li><strong>\u68C0\u67E5\u4E8B\u52A1\u72B6\u6001</strong>\uFF1A Broker\u4F1A\u5F00\u542F\u4E00\u4E2A\u5B9A\u65F6\u4EFB\u52A1\uFF0C\u6D88\u8D39RMQ_SYS_TRANS_HALF_TOPIC\u961F\u5217\u4E2D\u7684\u6D88\u606F\uFF0C\u6BCF\u6B21\u6267\u884C\u4EFB\u52A1\u4F1A\u5411\u6D88\u606F\u53D1\u9001\u8005\u786E\u8BA4\u4E8B\u52A1\u6267\u884C\u72B6\u6001\uFF08\u63D0\u4EA4\u3001\u56DE\u6EDA\u3001\u672A\u77E5\uFF09\uFF0C\u5982\u679C\u662F\u672A\u77E5\uFF0CBroker\u4F1A\u5B9A\u65F6\u53BB\u56DE\u8C03\u5728\u91CD\u65B0\u68C0\u67E5\u3002</li><li><strong>\u8D85\u65F6</strong>\uFF1A \u5982\u679C\u8D85\u8FC7\u56DE\u67E5\u6B21\u6570\uFF0C\u9ED8\u8BA4\u56DE\u6EDA\u6D88\u606F\u3002</li></ul><p>\u4E5F\u5C31\u662F\u4ED6\u5E76\u672A\u771F\u6B63\u8FDB\u5165Topic\u7684queue\uFF0C\u800C\u662F\u7528\u4E86\u4E34\u65F6queue\u6765\u653E\u6240\u8C13\u7684half message\uFF0C\u7B49\u63D0\u4EA4\u4E8B\u52A1\u540E\u624D\u4F1A\u771F\u6B63\u7684\u5C06half message\u8F6C\u79FB\u5230topic\u4E0B\u7684queue\u3002</p><h3 id="_1-24\u9AD8\u541E\u5410\u91CF\u4E0B\u5982\u4F55\u4F18\u5316\u751F\u4EA7\u8005\u548C\u6D88\u8D39\u8005\u7684\u6027\u80FD" tabindex="-1"><a class="header-anchor" href="#_1-24\u9AD8\u541E\u5410\u91CF\u4E0B\u5982\u4F55\u4F18\u5316\u751F\u4EA7\u8005\u548C\u6D88\u8D39\u8005\u7684\u6027\u80FD" aria-hidden="true">#</a> 1.24\u9AD8\u541E\u5410\u91CF\u4E0B\u5982\u4F55\u4F18\u5316\u751F\u4EA7\u8005\u548C\u6D88\u8D39\u8005\u7684\u6027\u80FD?</h3><ul><li>\u5F00\u53D1 <ul><li>\u540C\u4E00group\u4E0B\uFF0C\u591A\u673A\u90E8\u7F72\uFF0C\u5E76\u884C\u6D88\u8D39</li><li>\u5355\u4E2AConsumer\u63D0\u9AD8\u6D88\u8D39\u7EBF\u7A0B\u4E2A\u6570</li><li>\u6279\u91CF\u6D88\u8D39 <ul><li>\u6D88\u606F\u6279\u91CF\u62C9\u53D6</li><li>\u4E1A\u52A1\u903B\u8F91\u6279\u91CF\u5904\u7406</li></ul></li></ul></li><li>\u8FD0\u7EF4 <ul><li>\u7F51\u5361\u8C03\u4F18</li><li>jvm\u8C03\u4F18</li><li>\u591A\u7EBF\u7A0B\u4E0Ecpu\u8C03\u4F18</li><li>Page Cache</li></ul></li></ul><h3 id="_1-25rocketmq-\u662F\u5982\u4F55\u4FDD\u8BC1\u6570\u636E\u7684\u9AD8\u5BB9\u9519\u6027\u7684" tabindex="-1"><a class="header-anchor" href="#_1-25rocketmq-\u662F\u5982\u4F55\u4FDD\u8BC1\u6570\u636E\u7684\u9AD8\u5BB9\u9519\u6027\u7684" aria-hidden="true">#</a> 1.25RocketMQ \u662F\u5982\u4F55\u4FDD\u8BC1\u6570\u636E\u7684\u9AD8\u5BB9\u9519\u6027\u7684?</h3><ul><li>\u5728\u4E0D\u5F00\u542F\u5BB9\u9519\u7684\u60C5\u51B5\u4E0B\uFF0C\u8F6E\u8BE2\u961F\u5217\u8FDB\u884C\u53D1\u9001\uFF0C\u5982\u679C\u5931\u8D25\u4E86\uFF0C\u91CD\u8BD5\u7684\u65F6\u5019\u8FC7\u6EE4\u5931\u8D25\u7684Broker</li><li>\u5982\u679C\u5F00\u542F\u4E86\u5BB9\u9519\u7B56\u7565\uFF0C\u4F1A\u901A\u8FC7RocketMQ\u7684\u9884\u6D4B\u673A\u5236\u6765\u9884\u6D4B\u4E00\u4E2ABroker\u662F\u5426\u53EF\u7528</li><li>\u5982\u679C\u4E0A\u6B21\u5931\u8D25\u7684Broker\u53EF\u7528\u90A3\u4E48\u8FD8\u662F\u4F1A\u9009\u62E9\u8BE5Broker\u7684\u961F\u5217</li><li>\u5982\u679C\u4E0A\u8FF0\u60C5\u51B5\u5931\u8D25\uFF0C\u5219\u968F\u673A\u9009\u62E9\u4E00\u4E2A\u8FDB\u884C\u53D1\u9001</li><li>\u5728\u53D1\u9001\u6D88\u606F\u7684\u65F6\u5019\u4F1A\u8BB0\u5F55\u4E00\u4E0B\u8C03\u7528\u7684\u65F6\u95F4\u4E0E\u662F\u5426\u62A5\u9519\uFF0C\u6839\u636E\u8BE5\u65F6\u95F4\u53BB\u9884\u6D4Bbroker\u7684\u53EF\u7528\u65F6\u95F4</li></ul><p>\u5176\u5B9E\u5C31\u662Fsend\u6D88\u606F\u7684\u65F6\u5019queue\u7684\u9009\u62E9\u3002\u6E90\u7801\u5728\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>rocketmq<span class="token punctuation">.</span>client<span class="token punctuation">.</span>latency<span class="token punctuation">.</span></span>MQFaultStrategy</span>#<span class="token function">selectOneMessageQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-26\u4EFB\u4F55\u4E00\u53F0broker\u7A81\u7136\u5B95\u673A\u4E86\u600E\u4E48\u529E" tabindex="-1"><a class="header-anchor" href="#_1-26\u4EFB\u4F55\u4E00\u53F0broker\u7A81\u7136\u5B95\u673A\u4E86\u600E\u4E48\u529E" aria-hidden="true">#</a> 1.26\u4EFB\u4F55\u4E00\u53F0Broker\u7A81\u7136\u5B95\u673A\u4E86\u600E\u4E48\u529E\uFF1F</h3><p>Broker\u4E3B\u4ECE\u67B6\u6784\u4EE5\u53CA\u591A\u526F\u672C\u7B56\u7565\u3002Master \u6536\u5230\u6D88\u606F\u540E\u4F1A\u540C\u6B65\u7ED9 Slave\uFF0C\u8FD9\u6837\u4E00\u6761\u6D88\u606F\u5C31\u4E0D\u6B62\u4E00\u4EFD\u4E86\uFF0CMaster \u5B95\u673A\u4E86\u8FD8\u6709 slave \u4E2D\u7684\u6D88\u606F\u53EF\u7528\uFF0C\u4FDD\u8BC1\u4E86MQ\u7684\u53EF\u9760\u6027\u548C\u9AD8\u53EF\u7528\u6027\u3002\u800C\u4E14 Rocket MQ4.5.0 \u5F00\u59CB\u5C31\u652F\u6301\u4E86 Dlegder \u6A21\u5F0F\uFF0C\u57FA\u4E8E raft\u7684\uFF0C\u505A\u5230\u4E86\u771F\u6B63\u610F\u4E49\u7684 HA\u3002</p><h3 id="_1-27broker\u628A\u81EA\u5DF1\u7684\u4FE1\u606F\u6CE8\u518C\u5230\u54EA\u4E2Anameserver\u4E0A" tabindex="-1"><a class="header-anchor" href="#_1-27broker\u628A\u81EA\u5DF1\u7684\u4FE1\u606F\u6CE8\u518C\u5230\u54EA\u4E2Anameserver\u4E0A" aria-hidden="true">#</a> 1.27Broker\u628A\u81EA\u5DF1\u7684\u4FE1\u606F\u6CE8\u518C\u5230\u54EA\u4E2ANameServer\u4E0A\uFF1F</h3><p>\u6BCF\u4E2ABroker\u5411\u6240\u6709\u7684NameServer\u4E0A\u6CE8\u518C\u81EA\u5DF1\u7684\u4FE1\u606F\uFF0C\u5373\u6BCF\u4E2ANameServer\u4E0A\u6709\u6240\u6709\u7684Broker\u4FE1\u606F</p><h3 id="_1-28rocketmq\u5982\u4F55\u5206\u5E03\u5F0F\u5B58\u50A8\u6D77\u91CF\u6D88\u606F\u7684" tabindex="-1"><a class="header-anchor" href="#_1-28rocketmq\u5982\u4F55\u5206\u5E03\u5F0F\u5B58\u50A8\u6D77\u91CF\u6D88\u606F\u7684" aria-hidden="true">#</a> 1.28RocketMQ\u5982\u4F55\u5206\u5E03\u5F0F\u5B58\u50A8\u6D77\u91CF\u6D88\u606F\u7684\uFF1F</h3><p>RocketMQ \u8FDB\u7A0B\u4E00\u822C\u79F0\u4E3A Broker\uFF0C\u96C6\u7FA4\u90E8\u7F72\u7684\u5404\u4E2A Broker\u6536\u5230\u4E0D\u540C\u7684\u6D88\u606F\uFF0C\u7136\u540E\u5B58\u50A8\u5728\u81EA\u5DF1\u672C\u5730\u7684\u78C1\u76D8\u6587\u4EF6\u4E2D\u3002</p><h3 id="_1-29\u4EFB\u4F55\u4E00\u53F0-broker-\u7A81\u7136\u5B95\u673A\u4E86\u600E\u4E48\u529E-\u8FD8\u80FD\u4F7F\u7528\u5417-\u6D88\u606F\u4F1A\u4E0D\u4F1A\u4E22" tabindex="-1"><a class="header-anchor" href="#_1-29\u4EFB\u4F55\u4E00\u53F0-broker-\u7A81\u7136\u5B95\u673A\u4E86\u600E\u4E48\u529E-\u8FD8\u80FD\u4F7F\u7528\u5417-\u6D88\u606F\u4F1A\u4E0D\u4F1A\u4E22" aria-hidden="true">#</a> 1.29\u4EFB\u4F55\u4E00\u53F0 Broker \u7A81\u7136\u5B95\u673A\u4E86\u600E\u4E48\u529E\uFF1F\u8FD8\u80FD\u4F7F\u7528\u5417\uFF1F\u6D88\u606F\u4F1A\u4E0D\u4F1A\u4E22\uFF1F</h3><p>RocketMQ\u7684\u89E3\u51B3\u601D\u8DEF\u662FBroker\u4E3B\u4ECE\u67B6\u6784\u4EE5\u53CA\u591A\u526F\u672C\u7B56\u7565\u3002</p><p>Master\u6536\u5230\u6D88\u606F\u540E\u4F1A\u540C\u6B65\u7ED9Slave\uFF0C\u8FD9\u6837\u4E00\u6761\u6D88\u606F\u5C31\u4E0D\u6B62\u4E00\u4EFD\u4E86\uFF0CMaster\u5B95\u673A\u4E86\u8FD8\u6709slave\u4E2D\u7684\u6D88\u606F\u53EF\u7528\uFF0C\u4FDD\u8BC1\u4E86MQ\u7684\u53EF\u9760\u6027\u548C\u9AD8\u53EF\u7528\u65B0\u3002</p><h3 id="_1-30\u600E\u4E48\u77E5\u9053\u6709\u54EA\u4E9B-broker-\u5982\u4F55\u77E5\u9053\u8981\u8FDE\u90A3\u4E2Abroker" tabindex="-1"><a class="header-anchor" href="#_1-30\u600E\u4E48\u77E5\u9053\u6709\u54EA\u4E9B-broker-\u5982\u4F55\u77E5\u9053\u8981\u8FDE\u90A3\u4E2Abroker" aria-hidden="true">#</a> 1.30\u600E\u4E48\u77E5\u9053\u6709\u54EA\u4E9B Broker \uFF1F\u5982\u4F55\u77E5\u9053\u8981\u8FDE\u90A3\u4E2ABroker\uFF1F</h3><p>\u6709\u4E2ANameServer\u7684\u6982\u5FF5\uFF0C\u662F\u72EC\u7ACB\u90E8\u7F72\u5728\u51E0\u53F0\u673A\u5668\u4E0A\u7684\uFF0C\u7136\u540E\u6240\u6709\u7684Broker\u90FD\u4F1A\u628A\u81EA\u5DF1\u6CE8\u518C\u5230NameServer\u4E0A\u53BB\uFF0CNameServer\u5C31\u77E5\u9053\u96C6\u7FA4\u91CC\u6709\u54EA\u4E9BBroker\u4E86!</p><p>\u53D1\u9001\u6D88\u606F\u5230 Broker\uFF0C\u4F1A\u627E NameServer \u53BB\u83B7\u53D6\u8DEF\u7531\u4FE1\u606F \u7CFB\u7EDF\u8981\u4ECE Broker \u83B7\u53D6\u6D88\u606F\uFF0C\u4E5F\u4F1A\u627E NameServer \u83B7\u53D6\u8DEF\u7531\u4FE1\u606F\uFF0C\u53BB\u627E\u5230\u5BF9\u5E94\u7684 Broker \u83B7\u53D6\u6D88\u606F\u3002</p><h3 id="_1-31nameserver\u5230\u5E95\u53EF\u4EE5\u90E8\u7F72\u51E0\u53F0\u673A\u5668-\u4E3A\u4EC0\u4E48\u8981\u96C6\u7FA4\u5316\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#_1-31nameserver\u5230\u5E95\u53EF\u4EE5\u90E8\u7F72\u51E0\u53F0\u673A\u5668-\u4E3A\u4EC0\u4E48\u8981\u96C6\u7FA4\u5316\u90E8\u7F72" aria-hidden="true">#</a> 1.31NameServer\u5230\u5E95\u53EF\u4EE5\u90E8\u7F72\u51E0\u53F0\u673A\u5668\uFF1F\u4E3A\u4EC0\u4E48\u8981\u96C6\u7FA4\u5316\u90E8\u7F72\uFF1F</h3><p>\u90E8\u7F72\u591A\u53F0\uFF0C\u4FDD\u8BC1\u9AD8\u53EF\u7528\u6027\u3002</p><p>\u96C6\u7FA4\u5316\u90E8\u7F72\u662F\u4E3A\u4E86\u9AD8\u53EF\u7528\u6027\uFF0CNameServer \u662F\u96C6\u7FA4\u91CC\u975E\u5E38\u5173\u952E\u7684\u4E00\u4E2A\u89D2\u8272,\u5982\u679C\u90E8\u7F72\u4E00\u53F0 NameServer\uFF0C\u5B95\u673A\u4F1A\u5BFC\u81F4 RocketMQ \u96C6\u7FA4\u51FA\u73B0\u6545\u969C\uFF0C\u6240\u4EE5 NameServer \u4E00\u5B9A\u4F1A\u591A\u673A\u5668\u90E8\u7F72\uFF0C\u5B9E\u73B0\u4E00\u4E2A\u96C6\u7FA4\uFF0C\u8D77\u5230\u9AD8\u53EF\u7528\u7684\u6548\u679C\u3002</p><h3 id="_1-32\u7CFB\u7EDF\u5982\u4F55\u4ECEnameserver\u83B7\u53D6broker\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#_1-32\u7CFB\u7EDF\u5982\u4F55\u4ECEnameserver\u83B7\u53D6broker\u4FE1\u606F" aria-hidden="true">#</a> 1.32\u7CFB\u7EDF\u5982\u4F55\u4ECENameServer\u83B7\u53D6Broker\u4FE1\u606F\uFF1F</h3><p>\u7CFB\u7EDF\u4E3B\u52A8\u53BBNameServer\u4E0A\u62C9\u53D6Broker\u4FE1\u606F\u53CA\u5176\u4ED6\u76F8\u5173\u4FE1\u606F\u3002</p><h3 id="_1-33\u5982\u679Cbroker\u5B95\u4E86-nameserver\u662F\u600E\u4E48\u611F\u77E5\u5230\u7684" tabindex="-1"><a class="header-anchor" href="#_1-33\u5982\u679Cbroker\u5B95\u4E86-nameserver\u662F\u600E\u4E48\u611F\u77E5\u5230\u7684" aria-hidden="true">#</a> 1.33\u5982\u679CBroker\u5B95\u4E86\uFF0CNameServer\u662F\u600E\u4E48\u611F\u77E5\u5230\u7684\uFF1F</h3><p>Broker\u4F1A\u5B9A\u65F6\uFF0830s\uFF09\u5411NameServer\u53D1\u9001\u5FC3\u8DF3 \u7136\u540E NameServer\u4F1A\u5B9A\u65F6\uFF0810s\uFF09\u8FD0\u884C\u4E00\u4E2A\u4EFB\u52A1\uFF0C\u53BB\u68C0\u67E5\u4E00\u4E0B\u5404\u4E2ABroker\u7684\u6700\u8FD1\u4E00\u6B21\u5FC3\u8DF3\u65F6\u95F4\uFF0C\u5982\u679C\u67D0\u4E2ABroker\u8D85\u8FC7120s\u90FD\u6CA1\u53D1\u9001\u5FC3\u8DF3\u4E86\uFF0C\u90A3\u4E48\u5C31\u8BA4\u4E3A\u8FD9\u4E2ABroker\u5DF2\u7ECF\u6302\u6389\u4E86\u3002</p><h3 id="_1-34broker\u6302\u4E86-\u7CFB\u7EDF\u662F\u600E\u4E48\u611F\u77E5\u5230\u7684" tabindex="-1"><a class="header-anchor" href="#_1-34broker\u6302\u4E86-\u7CFB\u7EDF\u662F\u600E\u4E48\u611F\u77E5\u5230\u7684" aria-hidden="true">#</a> 1.34Broker\u6302\u4E86\uFF0C\u7CFB\u7EDF\u662F\u600E\u4E48\u611F\u77E5\u5230\u7684\uFF1F</h3><p>\u4E3B\u8981\u662F\u901A\u8FC7\u62C9\u53D6NameServer\u4E0ABroker\u7684\u4FE1\u606F\u3002 \u4F46\u662F\uFF0C\u56E0\u4E3ABroker\u5FC3\u8DF3\u3001NameServer\u5B9A\u65F6\u4EFB\u52A1\u3001\u751F\u4EA7\u8005\u548C\u6D88\u8D39\u8005\u62C9\u53D6Broker\u4FE1\u606F\uFF0C\u8FD9\u4E9B\u64CD\u4F5C\u90FD\u662F\u5468\u671F\u6027\u7684\uFF0C\u6240\u4EE5\u4E0D\u4F1A\u5B9E\u65F6\u611F\u77E5\uFF0C\u6240\u4EE5\u5B58\u5728\u53D1\u9001\u6D88\u606F\u548C\u6D88\u8D39\u6D88\u606F\u5931\u8D25\u7684\u60C5\u51B5\uFF0C\u73B0\u5728 \u6211\u4EEC\u5148\u77E5\u9053\uFF0C\u5BF9\u4E8E\u751F\u4EA7\u8005\u800C\u8A00\uFF0C\u4ED6\u662F\u6709 \u4E00\u5957\u5BB9\u9519\u673A\u5236\u7684\u3002</p><h3 id="_1-35master-broker-\u662F\u5982\u4F55\u5C06\u6D88\u606F\u540C\u6B65\u7ED9-slave-broker-\u7684" tabindex="-1"><a class="header-anchor" href="#_1-35master-broker-\u662F\u5982\u4F55\u5C06\u6D88\u606F\u540C\u6B65\u7ED9-slave-broker-\u7684" aria-hidden="true">#</a> 1.35Master Broker \u662F\u5982\u4F55\u5C06\u6D88\u606F\u540C\u6B65\u7ED9 Slave Broker \u7684\uFF1F</h3><p>RocketMQ \u81EA\u8EAB\u7684 Master-Slave \u6A21\u5F0F\u91C7\u53D6\u7684\u662F Pull \u6A21\u5F0F\u62C9\u53D6\u6D88\u606F\u3002</p><h3 id="_1-36\u6D88\u8D39\u6D88\u606F\u65F6\u662F\u4ECEmaster\u83B7\u53D6\u8FD8\u662Fslave\u83B7\u53D6" tabindex="-1"><a class="header-anchor" href="#_1-36\u6D88\u8D39\u6D88\u606F\u65F6\u662F\u4ECEmaster\u83B7\u53D6\u8FD8\u662Fslave\u83B7\u53D6" aria-hidden="true">#</a> 1.36\u6D88\u8D39\u6D88\u606F\u65F6\u662F\u4ECEMaster\u83B7\u53D6\u8FD8\u662FSlave\u83B7\u53D6\uFF1F</h3><p>\u53EF\u80FD\u4ECEMaster Broker\u83B7\u53D6\u6D88\u606F\uFF0C\u4E5F\u6709\u53EF\u80FD\u4ECESlave Broker\u83B7\u53D6\u6D88\u606F</p><ol><li>\u6D88\u8D39\u8005\u7684\u7CFB\u7EDF\u5728\u83B7\u53D6\u6D88\u606F\u7684\u65F6\u5019\u4F1A\u5148\u53D1\u9001\u8BF7\u6C42\u5230Master Broker\u4E0A\u53BB\uFF0C\u8BF7\u6C42\u83B7\u53D6\u4E00\u6279\u6D88\u606F\uFF0C\u6B64\u65F6Master Broker\u662F\u4F1A\u8FD4\u56DE\u4E00\u6279\u6D88\u606F\u7ED9\u6D88\u8D39\u8005\u7CFB\u7EDF\u7684</li><li>Master Broker\u5728\u8FD4\u56DE\u6D88\u606F\u7ED9\u6D88\u8D39\u8005\u7CFB\u7EDF\u7684\u65F6\u5019\uFF0C\u4F1A\u6839\u636E\u5F53\u65F6Master Broker\u7684 \u8D1F\u8F7D\u60C5\u51B5\u548CSlave Broker\u7684 \u540C\u6B65\u60C5\u51B5\uFF0C\u5411\u6D88\u8D39\u8005\u7CFB\u7EDF\u5EFA\u8BAE\u4E0B\u4E00\u6B21\u62C9\u53D6\u6D88\u606F\u7684\u65F6\u5019\u662F\u4ECEMaster Broker\u62C9\u53D6\u8FD8\u662F\u4ECESlave Broker\u62C9\u53D6\u3002</li></ol><h3 id="_1-37\u5982\u679C-slave-broker-\u6302\u6389\u4E86-\u4F1A\u5BF9\u6574\u4E2A\u7CFB\u7EDF\u6709\u5F71\u54CD\u5417" tabindex="-1"><a class="header-anchor" href="#_1-37\u5982\u679C-slave-broker-\u6302\u6389\u4E86-\u4F1A\u5BF9\u6574\u4E2A\u7CFB\u7EDF\u6709\u5F71\u54CD\u5417" aria-hidden="true">#</a> 1.37\u5982\u679C Slave Broker \u6302\u6389\u4E86\uFF0C\u4F1A\u5BF9\u6574\u4E2A\u7CFB\u7EDF\u6709\u5F71\u54CD\u5417\uFF1F</h3><p>\u6709\u4E00\u70B9\u5F71\u54CD\uFF0C\u4F46\u662F\u5F71\u54CD\u4E0D\u592A\u5927\uFF0C\u56E0\u4E3A\u6D88\u606F\u5199\u5165\u5168\u90E8\u662F\u53D1\u9001\u5230Master Broker\u7684\uFF0C\u83B7\u53D6\u6D88\u606F\u4E5F\u53EF\u4EE5Master\u83B7\u53D6\uFF0C\u5C11\u4E86Slave Broker\uFF0C\u4F1A\u5BFC\u81F4\u6240\u6709\u8BFB\u5199\u538B\u529B\u90FD\u96C6\u4E2D\u5728Master Broker</p><h3 id="_1-38master-broker-\u7A81\u7136\u6302\u4E86-\u8FD9\u6837\u4F1A\u600E\u4E48\u6837" tabindex="-1"><a class="header-anchor" href="#_1-38master-broker-\u7A81\u7136\u6302\u4E86-\u8FD9\u6837\u4F1A\u600E\u4E48\u6837" aria-hidden="true">#</a> 1.38Master Broker \u7A81\u7136\u6302\u4E86\uFF0C\u8FD9\u6837\u4F1A\u600E\u4E48\u6837\uFF1F</h3><p><strong>RocketMQ 4.5 \u7248\u672C\u4E4B\u524D</strong>\uFF0C\u7528 Slave Broker \u540C\u6B65\u6570\u636E\uFF0C\u5C3D\u91CF\u4FDD\u8BC1\u6570\u636E\u4E0D\u4E22\u5931\uFF0C\u4F46\u662F\u4E00\u65E6 Master \u6545\u969C\u4E86\uFF0CSlave \u662F\u6CA1\u6CD5\u81EA\u52A8\u5207\u6362\u6210 Master \u7684\u3002 \u6240\u4EE5\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u5982\u679C Master Broker \u5B95\u673A\u4E86\uFF0C\u8FD9\u65F6\u5C31\u5F97\u624B\u52A8\u505A\u4E00\u4E9B\u8FD0\u7EF4\u64CD\u4F5C\uFF0C\u628A Slave Broker \u91CD\u65B0\u4FEE\u6539\u4E00\u4E9B\u914D\u7F6E\uFF0C\u91CD\u542F\u673A\u5668\u7ED9\u8C03\u6574\u4E3AMaster Broker\uFF0C\u8FD9\u662F\u6709\u70B9\u9EBB\u70E6\u7684\uFF0C\u800C\u4E14\u4F1A\u5BFC\u81F4\u4E2D\u95F4\u4E00\u6BB5\u65F6\u95F4\u4E0D\u53EF\u7528\u3002</p><p><strong>RocketMQ 4.5\u4E4B\u540E</strong>\u652F\u6301\u4E86\u4E00\u79CD\u53EB\u505A Dledger \u673A\u5236\uFF0C\u57FA\u4E8E Raft \u534F\u8BAE\u5B9E\u73B0\u7684\u4E00\u4E2A\u673A\u5236\u3002 \u6211\u4EEC\u53EF\u4EE5\u8BA9\u4E00\u4E2A Master Broker \u5BF9\u5E94\u591A\u4E2A Slave Broker\uFF0C \u4E00\u65E6 Master Broker \u5B95\u673A\u4E86\uFF0C\u5728\u591A\u4E2A Slave \u4E2D\u901A\u8FC7 Dledger \u6280\u672F \u5C06\u4E00\u4E2A Slave Broker \u9009\u4E3A\u65B0\u7684 Master Broker \u5BF9\u5916\u63D0\u4F9B\u670D\u52A1\u3002 \u5728\u751F\u4EA7\u73AF\u5883\u4E2D\u53EF\u4EE5\u662F\u7528 Dledger \u673A\u5236\u5B9E\u73B0\u81EA\u52A8\u6545\u969C\u5207\u6362\uFF0C\u53EA\u898110\u79D2\u6216\u8005\u51E0\u5341\u79D2\u7684\u65F6\u95F4\u5C31\u53EF\u4EE5\u5B8C\u6210</p>`,113),p=[o];function r(l,c){return s(),a("div",null,p)}const k=n(t,[["render",r],["__file","RocketMQ.html.vue"]]);export{k as default};
